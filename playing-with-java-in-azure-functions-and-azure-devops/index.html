<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Playing with Java in Azure Functions and Azure DevOps | Nebrass Homepage</title><meta name=keywords content><meta name=description content="Before the introduction This is my first tutorial about one of the Microsoft&rsquo;s tools and platforms.. I started working for Microsoft on May 6th, I started to look to this huge and mysterious world by the eyes of a Java Developer. I will try to make some tutorials based on the great tools that I use or discover in the Microsoft ecosystem üòä
‚ö†Ô∏è Disclaimer : This is not a marketing content üòÜ I just want to share with you a feedback about tooling to boost your productivity and to make the Java journey wonderful üòç"><meta name=author content><link rel=canonical href=https://blog.nebrass.fr/playing-with-java-in-azure-functions-and-azure-devops/><link crossorigin=anonymous href=/assets/css/stylesheet.min.9aeab43847eb11aca320bfadedfe191ed6516dd768bf1314b534c4992aac901a.css integrity="sha256-muq0OEfrEayjIL+t7f4ZHtZRbddovxMUtTTEmSqskBo=" rel="preload stylesheet" as=style><script src=/js/prism.min.js></script>
<link rel=stylesheet href=/css/prism.min.css><link rel=icon href=https://blog.nebrass.fr/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.nebrass.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.nebrass.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.nebrass.fr/apple-touch-icon.png><link rel=mask-icon href=https://blog.nebrass.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><style amp-custom>.main,.footer,.nav{max-width:calc(var(--main-width) + var(--gap) * 15)}</style><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-111781986-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Playing with Java in Azure Functions and Azure DevOps"><meta property="og:description" content="Before the introduction This is my first tutorial about one of the Microsoft&rsquo;s tools and platforms.. I started working for Microsoft on May 6th, I started to look to this huge and mysterious world by the eyes of a Java Developer. I will try to make some tutorials based on the great tools that I use or discover in the Microsoft ecosystem üòä
‚ö†Ô∏è Disclaimer : This is not a marketing content üòÜ I just want to share with you a feedback about tooling to boost your productivity and to make the Java journey wonderful üòç"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.nebrass.fr/playing-with-java-in-azure-functions-and-azure-devops/"><meta property="og:image" content="https://blog.nebrass.fr/images/playing-with-java-in-azure-functions-and-azure-devops.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-08-09T00:00:00+00:00"><meta property="article:modified_time" content="2019-08-09T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.nebrass.fr/images/playing-with-java-in-azure-functions-and-azure-devops.webp"><meta name=twitter:title content="Playing with Java in Azure Functions and Azure DevOps"><meta name=twitter:description content="Before the introduction This is my first tutorial about one of the Microsoft&rsquo;s tools and platforms.. I started working for Microsoft on May 6th, I started to look to this huge and mysterious world by the eyes of a Java Developer. I will try to make some tutorials based on the great tools that I use or discover in the Microsoft ecosystem üòä
‚ö†Ô∏è Disclaimer : This is not a marketing content üòÜ I just want to share with you a feedback about tooling to boost your productivity and to make the Java journey wonderful üòç"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.nebrass.fr/posts/"},{"@type":"ListItem","position":3,"name":"Playing with Java in Azure Functions and Azure DevOps","item":"https://blog.nebrass.fr/playing-with-java-in-azure-functions-and-azure-devops/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Playing with Java in Azure Functions and Azure DevOps","name":"Playing with Java in Azure Functions and Azure DevOps","description":"Before the introduction This is my first tutorial about one of the Microsoft\u0026rsquo;s tools and platforms.. I started working for Microsoft on May 6th, I started to look to this huge and mysterious world by the eyes of a Java Developer. I will try to make some tutorials based on the great tools that I use or discover in the Microsoft ecosystem üòä\n‚ö†Ô∏è Disclaimer : This is not a marketing content üòÜ I just want to share with you a feedback about tooling to boost your productivity and to make the Java journey wonderful üòç","keywords":[],"articleBody":"Before the introduction This is my first tutorial about one of the Microsoft‚Äôs tools and platforms.. I started working for Microsoft on May 6th, I started to look to this huge and mysterious world by the eyes of a Java Developer. I will try to make some tutorials based on the great tools that I use or discover in the Microsoft ecosystem üòä\n‚ö†Ô∏è Disclaimer : This is not a marketing content üòÜ I just want to share with you a feedback about tooling to boost your productivity and to make the Java journey wonderful üòç\nIntroduction Serverless computing is an architecture that aims to delegate the execution of a piece of code to the cloud, where necessary resources will be dynamically allocated. Dynamic allocation means always the pay-as-you-go model when we are hosting the code on a Public Cloud Provider.\nThe serverless application is composed by functions triggered by some event like an HTTP Request, a Message (Kafka for example) or even a Scheduled event. That‚Äôs why, we refer to the serverless applications as ‚ÄúFunctions as a Service‚Äù¬†or¬†‚ÄúFaaS‚Äù.\nToday, I will make my first tutorial with Microsoft Azure FaaS which is called Azure Functions.\nWhat is Azure Functions We will be based on the Microsoft‚Äôs¬†presentation of Azure Functions:\n Azure Functions is a solution for easily running small pieces of code, or ‚Äúfunctions,‚Äù in the cloud. You can write just the code you need for the problem at hand, without worrying about a whole application or the infrastructure to run it. Functions can make development even more productive, and you can use your development language of choice, such as C#, Java, JavaScript, Python, or PHP. Pay only for the time your code runs and trust Azure to scale as needed. Azure Functions lets you develop¬†serverless applications on Microsoft Azure.\n Requirements for this tutorial To do this tutorial, you will need an Azure Subscription. If you don‚Äôt already have one, you can get one with free 200$ credit from this link:\n In the Free Tier account, we can have up to 1 Million requests per month for FREE !!\nCreating the Azure Function App The first step is to create the new Function on the Azure Portal: https://portal.azure.com\nNext, go to the Function App and when you click on Add you will get this window:\n Fill this form with this details:\n App name: the Function App name and will be used in the application‚Äôs URL: https://APP_NAME.azurewebsites.net üëâ I will call it: hello-world-example -the application will be reachable on the URL https://hello-world-example.azurewebsites.net/ Resource Group: a logical container that will be holding Azure Resources, like the Function App here üëâ in this tutorial we are creating a new one called hello-world-example-rg OS: We will choose Windows as it has the Java Runtime Stack. Hosting Plan: The Consumption plan lets you pay-per-execution and dynamically allocates resources based on your app‚Äôs load. App Service Plans let you use a predefined capacity allocation with predictable costs and scale üëâ we need to choose Consumption plan. Location: The nearest one for me is France Central. Runtime Stack: Obviously Java üòÅ Storage: We will create a new one üòÉ Maybe we will need it later ü§™ Application Insights: an Azure monitoring platform that we will enable to monitor the Function App¬†üëâ Just click on Application insights and Enable the Collect application monitoring data using Application Insights: Then Apply next click on Create  Create your first function code After the application is created, it‚Äôs time to add code. To do that, click on your new application on the Function Apps list, to access to the application content:\n Next, click on the New function button:\n We will chose Any editor + Maven and proceed to next step:\n For the deployment method, we will use Use Deployment Center¬†and proceed to next step:\n In this section of the wizard, there are many important sections: like installing dependencies and how to create an Azure Functions project via Maven, which is the important part.\nClick Finish and go to Deployment Center to finish the wizard.\nCreate the maven project The Maven command showed in the quickstart wizard looks like:\n1 2 3 4 5 6 7 8 9  $ mvn archetype:generate -DarchetypeGroupId=com.microsoft.azure -DarchetypeArtifactId=azure-functions-archetype -DappName=hello-world-example -DappRegion={region} -DresourceGroup={resourceGroup} -DgroupId=com.{functionAppName}.group -DartifactId={functionAppName}-functions -Dpackage=com.{functionAppName} -DinteractiveMode=false   With in my case:\n region: FranceCentral resourceGroup: hello-world-example functionAppName: helloworldexample  After generating the Maven Project, just enable the Git version control by typing:\n1  $ git init   Add all the generated files to Git:\n1  $ git add .   Commit the changes to Git:\n1  $ git commit -am \"First Commit\"   import the project in the Azure DevOps First of all, we need to create a project in Azure DevOps. Ok but what is Azure DevOps ? üòÜ\nAzure DevOps is a Software as a Service (SaaS) from Microsoft that provides many great features for Software Teams - which cover all the lifecycle of a typical application:\n Azure Pipelines: CI/CD that works with any language, platform, and cloud (not only Azure üòÅ) Azure Boards: Powerful work tracking with Kanban boards, backlogs, team dashboards, and custom reporting. Azure Artifacts: Maven, npm, and NuGet package feeds from public and private sources. Azure Repos: Unlimited cloud-hosted private Git repos for your project. Collaborative pull requests, advanced file management, and more. Azure Test Plans: All in one planned and exploratory testing solution.  For the used Java developers; Yes, Azure DevOps is a great alternative of Jenkins/Hudson.\nFirst of all, go to the Azure DevOps portal:\n Click Start free to create an account..\nNext.. authenticate to your Oulook/Hotmail/Live account..\nNext.. create your first project:\n Next, when the project is created, you will be redirected to the Dashboard:\n Go to the Repos section:\n Next.. we need to authenticate the Git CLI to be able to push code and do operation from the CLI on this repository.. to do that.. Azure DevOps offers a great one-time generated passwords that you can directly get when you click on Generate Git credentials..\nNext.. we will go to our generated Maven project and add our Azure DevOps Git repository as remote repository:\n1  $ git remote add origin https://lnibrass@dev.azure.com/lnibrass/hello-azure-functions/_git/hello-azure-functions   Next.. we will push all our code to the Azure DevOps Git repository:\n1  $ git push -u origin --all   When files are pushed to the repository:\n Create the Azure DevOps CI/CD Pipelines Continuous integration To create our first Build pipeline, just go to Pipelines üëâ Builds and click on New pipeline..\n Next.. click on Use the classic editor:\n Next.. choose the Source of the project:\n Next.. the wizard will be listing some templates; obviously, we will choose the Maven template:\n Next.. you will be redirected to the job content..\nIn Azure DevOps, every job (Integration or Delivery) is composed of some tasks .. a Task is a step that can be doing some specific logic in the job.. for example..\nAs we will have steps to execute, before diving into them, we need to know the Agent pool that will be running them: Why we need to define an agent? They‚Äôre not similar?\nWe define an agent because they are some tasks that can be done exclusively by a specific kind of agents, for example, building DotNet framework üí© requires to have a Windows based agent.. in our example will be using an Ubuntu based agent:\n In our Maven, we can have some separate tasks, for example:\n mvn package üëâ for building the project mvn sonar:sonar üëâ for executing the Sonar quality gates  We can have other needs or constraints that require to have a specific task üò∏ for example; if you need to do some Bash command, or copy some files from somewhere..\nLet‚Äôs see how looks a job ?\n In the previous screenshot, we can enter the Maven goal that we want to run.. the same way as like your OS CLI.. and there are more you can enable the SonarQube reporting just by some clicks in this same task, on the Code Coverage section:\n In my tutorial, I will just be building the Maven project without running the tests ‚ò†Ô∏è Yes ! I know it‚Äôs a bull üí©üí©üí©üí© but for our case, I need to show how it works ! ü§°\nSo my Maven Goals:\nclean install -DskipTests\nAfter that we run our Maven task, the pipeline will¬†:\n1Ô∏è‚É£ Copy Files to: $(build.artifactstagingdirectory) üëâ¬†In this task, we will be copying the packaged project to a dedicated folder, so we can use the output of the previous task in the incoming tasks.\nOur Azure Functions Java application is a Maven based project, so when we build our project, we will get the packaged and built files in the target¬†subfolder of our project folder.\nSo we will be copying the files that are available in the target subfolder. So the Copy task will look like:\n  The $(something) are predefined variables of Azure DevOps pipelines. More info here.\n 2Ô∏è‚É£ Publish Artifact: drop üëâ In this task we will be publishing the files that we grabbed from the previous task to a some network reachable location so it can be used later in the Continuous Deployment pipeline.\nNow.. we need to enable the Continuous integration to start a new Build when new code is pushed to the master branch of our Git Repository:\n Now, everything is ready, we can go to prepare our CD pipeline.. ü§ì\nContinuous Deployment To create our first Release pipeline, just go to Pipelines üëâ Releases and click on New pipeline..\nIn the wizard, we will choose the Deploy a function app to Azure Functions..\n Next.. in the Artifacts source, we will define the Source (which is the Build pipeline) to the one that we created in the previous step:\n Next.. we need to enable the Continuous deployment trigger to create a release every time a new build is available:\n Now, we will go to configure the Stage 1 of the Release Pipeline:\nIn this step, we need to give the access of the Azure DevOps Pipeline to the Azure Subscription:\n Choose your Azure Subscription, and next click on Authorize¬†to configure an Azure service connection. A new Azure service principal will be created and added to the Contributor role, having access to all resources in the selected subscription.\nIn the :\n App type, choose the Function App on Windows App Service name, enter the application name that we created in the beginning: hello-world-example   Next.. click on the Deploy Azure Function App step to configure it:\nIn the Package or Folder choose: $(System.DefaultWorkingDirectory)/_hello-azure-functions-Maven-CI/drop/target/azure-functions/hello-world-example\n Next.. click on Create Release to create a new Release:\n Click Create and click next on the Release name that is shown, to follow the build process:\n The Release build process will look like:\n We need to wait until the Build succeeds:\n Now.. go back to the Azure Portal üëâ Resource Groups called hello-world-example-rgüëâ Function App called hello-world-example:\n Under the Function Apps there are our hello-world-example application. In this tree there is a Functions (Read Only) section, which lists all the Functions that are included in our application.\nIf you click on the HttpTrigger-Java you will get something that looks like this:\n Click on  Get function URL to get and test the function URL:\n When you click Copy and you past it to a browser you can see the function response which looks like\nPlease pass a name on the query string or in the request body\nWTF!! üò±üò±üò±üò±\nThis is normal, the sample function needs some specific input to provide some response. So, now we will dive into the Java ecosystem ü•∞\nLet‚Äôs look to the sample project:\n In the sample project, we have only one Java class called Function. It‚Äôs content looks like:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  public class Function { ... @FunctionName(\"HttpTrigger-Java\") public HttpResponseMessage run( @HttpTrigger(name = \"req\", methods = {HttpMethod.GET, HttpMethod.POST}, authLevel = AuthorizationLevel.FUNCTION) HttpRequestMessageOptionalString request, final ExecutionContext context) { context.getLogger().info(\"Java HTTP trigger processed a request.\"); // Parse query parameter  String query = request.getQueryParameters().get(\"name\"); String name = request.getBody().orElse(query); if (name == null) { return request .createResponseBuilder(HttpStatus.BAD_REQUEST) .body(\"Please pass a name on the query string or in the request body\") .build(); } else { return request .createResponseBuilder(HttpStatus.OK).body(\"Hello, \" + name) .build(); } } }   In the line (5) we have the @FunctionName¬†annotation that contains the HttpTrigger-Java which is the Function name. This indicates that this function will be available at the endpoint /api/HttpTrigger-Java.\nThere is only one method called run(...)¬†which is the Function body; we pass to this method some arguments:\n HttpRequestMessage request : This indicates that the body of the request will potentially contain a String value - this argument is annotated with the @HttpTrigger annotation. In this annotation you‚Äôll note that it has been given a name req, as well as told what type of requests it supports (in this case, only HTTP GET and POST requests), and that the AuthorizationLevel¬†is anonymous, allowing access to anyone who can call the endpoint. final ExecutionContext context¬†: The execution context enables interaction with the Azure Functions execution environment. Used for accessing the Java Logger that will see output directed to Azure Portal, as well as any other configured output¬†locations.  So based on this code, if I add a name parameter to the Function URL, I will get a response üòÅ\nThe old URL is :\nhttps://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==\nThe new URL with the name parameter will look like:\nhttps://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?name=nebrass\u0026code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==\nWe will get a response like Hello, nebrass¬†ü•≥\nNow, we can change a little bit the code of our HttpTrigger-Java function to be like:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  public class Function { @FunctionName(\"HttpTrigger-Java\") public HttpResponseMessage run( @HttpTrigger( name = \"req\", methods = {HttpMethod.GET, HttpMethod.POST}, authLevel = AuthorizationLevel.FUNCTION ) HttpRequestMessageOptionalString request, final ExecutionContext context) { context.getLogger().info(\"Java HTTP trigger processed a request.\"); return request.createResponseBuilder(HttpStatus.OK) .body(\"Hello World at \" + LocalDateTime.now().toString()) .build(); } }   After you commit, the Build pipeline will be executed and when it succeeds, the Release pipeline will be started to deploy the new code.\nIf you go now to the function URL:\nhttps://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==\nYou will get the new output message: Hello World at 2019-08-09T12:25:24.035\nTriggers and bindings I will be covering more the Triggers and Bindings in my next post about the fabulous Azure Java Functions:\nhttps://blog.nebrass.fr/playing-with-java-in-azure-functions-new-release/\nDo more üòé You can do more with Azure Functions:\n Azure Functions Java developer guide Spring Cloud Function 2.0 and Azure Functions  Not final words The Azure Functions is a very powerful product and it can be very useful in many use-cases when we are working with events-driven logic such as doing some business tasks when new file is uploaded in Azure Storage or when a new message is dispatched to Azure Event Hub.\nActually, Azure Functions support Java 8. To follow updates about the Java 11 and 12 support check this ticket and this one also.\n","wordCount":"2500","inLanguage":"en","image":"https://blog.nebrass.fr/images/playing-with-java-in-azure-functions-and-azure-devops.webp","datePublished":"2019-08-09T00:00:00Z","dateModified":"2019-08-09T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.nebrass.fr/playing-with-java-in-azure-functions-and-azure-devops/"},"publisher":{"@type":"Organization","name":"Nebrass Homepage","logo":{"@type":"ImageObject","url":"https://blog.nebrass.fr/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.nebrass.fr accesskey=h title="Nebrass Homepage (Alt + H)">Nebrass Homepage</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://blog.nebrass.fr/ title=Posts><span>Posts</span></a></li><li><a href=https://blog.nebrass.fr/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.nebrass.fr/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Playing with Java in Azure Functions and Azure DevOps</h1><div class=post-meta><span title="2019-08-09 00:00:00 +0000 UTC">August 9, 2019</span>&nbsp;¬∑&nbsp;12 min</div></header><figure class=entry-cover><img loading=lazy src=https://blog.nebrass.fr/images/playing-with-java-in-azure-functions-and-azure-devops.webp alt></figure><div class=post-content><h2 id=before-the-introduction>Before the introduction<a hidden class=anchor aria-hidden=true href=#before-the-introduction>#</a></h2><p>This is my first tutorial about one of the Microsoft&rsquo;s tools and platforms.. I started working for Microsoft on May 6th, I started to look to this huge and mysterious world by the eyes of a Java Developer. I will try to make some tutorials based on the great tools that I use or discover in the Microsoft ecosystem üòä</p><p>‚ö†Ô∏è Disclaimer : This is not a marketing content üòÜ I just want to share with you a feedback about tooling to boost your productivity and to make the Java journey wonderful üòç</p><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Serverless computing is an architecture that aims to delegate the execution of a piece of code to the cloud, where necessary resources will be dynamically allocated. Dynamic allocation means always the <em><strong>pay-as-you-go</strong></em> model when we are hosting the code on a Public Cloud Provider.</p><p>The serverless application is composed by <strong><em>functions</em></strong> triggered by some event like an HTTP Request, a Message (Kafka for example) or even a Scheduled event. That&rsquo;s why, we refer to the serverless applications as <em>&ldquo;Functions as a Service&rdquo;</em>¬†or¬†<em>&ldquo;FaaS&rdquo;</em>.</p><p>Today, I will make my first tutorial with Microsoft Azure FaaS which is called <a href=https://azure.microsoft.com/en-us/services/functions/>Azure Functions</a>.</p><h2 id=what-is-azure-functions>What is Azure Functions<a hidden class=anchor aria-hidden=true href=#what-is-azure-functions>#</a></h2><p>We will be based on the Microsoft&rsquo;s¬† presentation of Azure Functions:</p><blockquote><p>Azure Functions is a solution for easily running small pieces of code, or &ldquo;functions,&rdquo; in the cloud. You can write just the code you need for the problem at hand, without worrying about a whole application or the infrastructure to run it. Functions can make development even more productive, and you can use your development language of choice, such as C#, Java, JavaScript, Python, or PHP. Pay only for the time your code runs and trust Azure to scale as needed. Azure Functions lets you develop¬†<a href=https://azure.microsoft.com/solutions/serverless/>serverless</a> applications on Microsoft Azure.</p></blockquote><h2 id=requirements-for-this-tutorial>Requirements for this tutorial<a hidden class=anchor aria-hidden=true href=#requirements-for-this-tutorial>#</a></h2><p>To do this tutorial, you will need an Azure Subscription. If you don&rsquo;t already have one, you can get one with free 200$ credit from <a href=https://azure.microsoft.com/en-us/free/>this link</a>:</p><div align=center><p><img loading=lazy src=../images/free-azure-credit.webp alt></p></div><p>In the Free Tier account, we can have up to 1 Million requests per month for FREE !!</p><h2 id=creating-the-azure-function-app>Creating the Azure Function App<a hidden class=anchor aria-hidden=true href=#creating-the-azure-function-app>#</a></h2><p>The first step is to create the new Function on the Azure Portal: <a href=https://portal.azure.com>https://portal.azure.com</a></p><p>Next, go to the <em><strong>Function App</strong></em> and when you click on <strong><em>Add</em></strong> you will get this window:</p><div align=center><p><img loading=lazy src=../images/create-function-step1.webp alt></p></div><p>Fill this form with this details:</p><ul><li><strong>App name:</strong> the Function App name and will be used in the application&rsquo;s URL: <a href=https://APP_NAME.azurewebsites.net>https://APP_NAME.azurewebsites.net</a> üëâ I will call it: <em>hello-world-example</em> -the application will be reachable on the URL <a href=https://hello-world-example.azurewebsites.net/>https://hello-world-example.azurewebsites.net/</a></li><li><strong>Resource Group:</strong> a logical container that will be holding Azure Resources, like the Function App here üëâ in this tutorial we are creating a new one called <em>hello-world-example-rg</em></li><li><strong>OS:</strong> We will choose <em>Windows</em> as it has the <em>Java</em> <em>Runtime Stack.</em></li><li><strong>Hosting Plan:</strong> The Consumption plan lets you pay-per-execution and dynamically allocates resources based on your app&rsquo;s load. App Service Plans let you use a predefined capacity allocation with predictable costs and scale üëâ we need to choose <em>Consumption plan.</em></li><li><strong>Location:</strong> The nearest one for me is <em>France Central.</em></li><li><strong>Runtime Stack:</strong> Obviously <em>Java üòÅ</em></li><li><strong>Storage:</strong> We will create a new one üòÉ Maybe we will need it later ü§™</li><li><strong>Application Insights:</strong> an Azure monitoring platform that we will enable to monitor the Function App¬†üëâ Just click on <em><strong>Application insights</strong></em> and <em>Enable</em> the <em>Collect application monitoring data using Application Insights:</em> <img loading=lazy src=../images/apps-insights-enable.webp alt>
Then <em><strong>Apply</strong></em> next click on <strong><em>Create</em></strong></li></ul><h2 id=create-your-first-function-code>Create your first function code<a hidden class=anchor aria-hidden=true href=#create-your-first-function-code>#</a></h2><p>After the application is created, it&rsquo;s time to add code. To do that, click on your new application on the Function Apps list, to access to the application content:</p><div align=center><p><img loading=lazy src=../images/function-app-details.webp alt></p></div><p>Next, click on the <em><strong>New function</strong></em> button:</p><div align=center><p><img loading=lazy src=../images/getting-started-azure-func-java-step1.webp alt></p></div><p>We will chose <strong><em>Any editor + Maven</em></strong> and proceed to next step:</p><div align=center><p><img loading=lazy src=../images/getting-started-azure-func-java-step2.webp alt></p></div><p>For the deployment method, we will use <em><strong>Use Deployment Center</strong></em>¬†and proceed to next step:</p><div align=center><p><img loading=lazy src=../images/getting-started-azure-func-java-step3.webp alt></p></div><p>In this section of the wizard, there are many important sections: like installing dependencies and how to create an <em><strong>Azure Functions</strong></em> project via <strong><em>Maven</em></strong>, which is the important part.</p><p>Click <em><strong>Finish and go to Deployment Center</strong></em> to finish the wizard.</p><h2 id=create-the-maven-project>Create the maven project<a hidden class=anchor aria-hidden=true href=#create-the-maven-project>#</a></h2><p>The <em><strong>Maven</strong></em> command showed in the quickstart wizard looks like:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mvn archetype:generate
</span></span><span class=line><span class=cl>    -DarchetypeGroupId<span class=o>=</span>com.microsoft.azure 
</span></span><span class=line><span class=cl>    -DarchetypeArtifactId<span class=o>=</span>azure-functions-archetype 
</span></span><span class=line><span class=cl>    -DappName<span class=o>=</span>hello-world-example 
</span></span><span class=line><span class=cl>    -DappRegion<span class=o>={</span>region<span class=o>}</span> 
</span></span><span class=line><span class=cl>    -DresourceGroup<span class=o>={</span>resourceGroup<span class=o>}</span> 
</span></span><span class=line><span class=cl>    -DgroupId<span class=o>=</span>com.<span class=o>{</span>functionAppName<span class=o>}</span>.group 
</span></span><span class=line><span class=cl>    -DartifactId<span class=o>={</span>functionAppName<span class=o>}</span>-functions 
</span></span><span class=line><span class=cl>    -Dpackage<span class=o>=</span>com.<span class=o>{</span>functionAppName<span class=o>}</span> -DinteractiveMode<span class=o>=</span><span class=nb>false</span>
</span></span></code></pre></td></tr></table></div></div><p>With in my case:</p><ul><li>region: <em>FranceCentral</em></li><li>resourceGroup: <em>hello-world-example</em></li><li>functionAppName: <em>helloworldexample</em></li></ul><p>After generating the Maven Project, just enable the Git version control by typing:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git init
</span></span></code></pre></td></tr></table></div></div><p>Add all the generated files to Git:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git add .
</span></span></code></pre></td></tr></table></div></div><p>Commit the changes to Git:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git commit -am <span class=s2>&#34;First Commit&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=import-the-project-in-the-azure-devops>import the project in the Azure DevOps<a hidden class=anchor aria-hidden=true href=#import-the-project-in-the-azure-devops>#</a></h2><p>First of all, we need to create a project in Azure DevOps. Ok but what is Azure DevOps ? üòÜ</p><p>Azure DevOps is a Software as a Service (SaaS) from Microsoft that provides many great features for Software Teams - which cover all the lifecycle of a typical application:</p><ul><li>Azure Pipelines: CI/CD that works with any language, platform, and cloud (not only Azure üòÅ)</li><li>Azure Boards: Powerful work tracking with Kanban boards, backlogs, team dashboards, and custom reporting.</li><li>Azure Artifacts: Maven, npm, and NuGet package feeds from public and private sources.</li><li>Azure Repos: Unlimited cloud-hosted private Git repos for your project. Collaborative pull requests, advanced file management, and more.</li><li>Azure Test Plans: All in one planned and exploratory testing solution.</li></ul><p>For the used Java developers; Yes, <strong>Azure DevOps</strong> is a great alternative of <strong>Jenkins/Hudson</strong>.</p><p>First of all, go to the <a href=https://dev.azure.com>Azure DevOps portal</a>:</p><div align=center><p><img loading=lazy src=../images/azure-devops-home.webp alt></p></div><p>Click <em><strong>Start free</strong></em> to create an account..</p><p>Next.. authenticate to your <em>Oulook/Hotmail/Live</em> account..</p><p>Next.. create your first project:</p><div align=center><p><img loading=lazy src=../images/azure-devops-getting-started.webp alt></p></div><p>Next, when the project is created, you will be redirected to the <em><strong>Dashboard</strong></em>:</p><div align=center><p><img loading=lazy src=../images/azure-devops-first-project.webp alt></p></div><p>Go to the <em><strong>Repos</strong></em> section:</p><div align=center><p><img loading=lazy src=../images/azure-devops-repos-first.webp alt></p></div><p>Next.. we need to authenticate the <strong>Git CLI</strong> to be able to push code and do operation from the <strong>CLI</strong> on this repository.. to do that.. <strong>Azure DevOps</strong> offers a great one-time generated passwords that you can directly get when you click on <em><strong>Generate Git credentials</strong></em>..</p><p>Next.. we will go to our generated Maven project and add our <em><strong>Azure DevOps Git repository</strong></em> as remote repository:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git remote add origin https://lnibrass@dev.azure.com/lnibrass/hello-azure-functions/_git/hello-azure-functions
</span></span></code></pre></td></tr></table></div></div><p>Next.. we will push all our code to the <em><strong>Azure DevOps Git repository</strong></em>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git push -u origin --all
</span></span></code></pre></td></tr></table></div></div><p>When files are pushed to the <strong><em>repository</em></strong>:</p><div align=center><p><img loading=lazy src=../images/devops-files-repo.webp alt></p></div><h2 id=create-the-azure-devops-cicd-pipelines>Create the Azure DevOps CI/CD Pipelines<a hidden class=anchor aria-hidden=true href=#create-the-azure-devops-cicd-pipelines>#</a></h2><h3 id=continuous-integration>Continuous integration<a hidden class=anchor aria-hidden=true href=#continuous-integration>#</a></h3><p>To create our first <em><strong>Build pipeline</strong></em>, just go to <em><strong>Pipelines</strong></em> üëâ <strong><em>Builds</em></strong> and click on <em><strong>New pipeline</strong></em>..</p><div align=center><p><img loading=lazy src=../images/devops-build-section.webp alt></p></div><p>Next.. click on <em><strong>Use the classic editor</strong></em>:</p><div align=center><p><img loading=lazy src=../images/devops-build-new-pipeline-step1.webp alt></p></div><p>Next.. choose the <em><strong>Source</strong></em> of the project:</p><div align=center><p><img loading=lazy src=../images/devops-build-new-pipeline-step2.webp alt></p></div><p>Next.. the wizard will be listing some templates; obviously, we will choose the <strong><em>Maven</em></strong> template:</p><div align=center><p><img loading=lazy src=../images/devops-build-new-pipeline-step3.webp alt></p></div><p>Next.. you will be redirected to the <em><strong>job</strong></em> content..</p><p>In Azure DevOps, every job (Integration or Delivery) is composed of some <em><strong>tasks</strong></em> .. a <em><strong>Task</strong></em> is a step that can be doing some specific logic in the <em><strong>job</strong></em>.. for example..</p><p>As we will have steps to execute, before diving into them, we need to know the <em><strong>Agent pool</strong></em> that will be running them: Why we need to define an agent? They&rsquo;re not similar?</p><p>We define an agent because they are some tasks that can be done exclusively by a specific kind of agents, for example, building <em>DotNet framework üí©</em> requires to have a Windows based agent.. in our example will be using an <em><strong>Ubuntu</strong></em> based agent:</p><div align=center><p><img loading=lazy src=../images/devops-build-agent-pool.webp alt></p></div><p>In our <em><strong>Maven</strong></em>, we can have some separate tasks, for example:</p><ul><li><code>mvn package</code> üëâ for building the project</li><li><code>mvn sonar:sonar</code> üëâ for executing the Sonar quality gates</li></ul><p>We can have other needs or constraints that require to have a specific <em><strong>task</strong></em> üò∏ for example; if you need to do some <em>Bash</em> command, or copy some files from somewhere..</p><p>Let&rsquo;s see how looks a <em><strong>job</strong></em> ?</p><div align=center><p><img loading=lazy src=../images/devops-build-new-pipeline-maven.webp alt></p></div><p>In the previous screenshot, we can enter the <em><strong>Maven</strong></em> goal that we want to run.. the same way as like your OS CLI.. and there are more you can enable the <em><strong>SonarQube</strong></em> reporting just by some clicks in this same <strong><em>task</em></strong>, on the <strong>Code Coverage</strong> section:</p><div align=center><p><img loading=lazy src=../images/devops-build-maven-code-coverage.webp alt></p></div><p>In my tutorial, I will just be building the Maven project without running the tests ‚ò†Ô∏è Yes ! I know it&rsquo;s a bull üí©üí©üí©üí© but for our case, I need to show how it works ! ü§°</p><p>So my <strong>Maven Goals</strong>:</p><p>clean install -DskipTests</p><p>After that we run our Maven task, the pipeline will¬† :</p><p><strong>1Ô∏è‚É£ Copy Files to: $(build.artifactstagingdirectory) üëâ</strong>¬† In this task, we will be copying the packaged project to a dedicated folder, so we can use the output of the previous task in the incoming tasks.</p><p>Our <strong>Azure Functions Java application</strong> is a Maven based project, so when we build our project, we will get the packaged and built files in the <strong><em>target</em></strong>¬†subfolder of our project folder.</p><p>So we will be copying the files that are available in the <strong><em>target</em></strong> subfolder. So the Copy task will look like:</p><div align=center><p><img loading=lazy src=../images/devops-build-maven-copy.webp alt></p></div><blockquote><p>The $(something) are predefined variables of Azure DevOps pipelines. <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/build/variables?view=azure-devops&tabs=yaml">More info here</a>.</p></blockquote><p><strong>2Ô∏è‚É£ Publish Artifact: drop üëâ</strong> In this task we will be publishing the files that we grabbed from the previous task to a some network reachable location so it can be used later in the <em><strong>Continuous Deployment</strong></em> pipeline.</p><p>Now.. we need to enable the <em><strong>Continuous integration</strong></em> to start a new <em><strong>Build</strong></em> when new code is pushed to the <em>master branch</em> of our <em><strong>Git Repository</strong></em>:</p><div align=center><p><img loading=lazy src=../images/devops-release-ci-trigger.webp alt></p></div><p>Now, everything is ready, we can go to prepare our CD pipeline.. ü§ì</p><h3 id=continuous-deployment>Continuous Deployment<a hidden class=anchor aria-hidden=true href=#continuous-deployment>#</a></h3><p>To create our first <em><strong>Release pipeline</strong></em>, just go to <em><strong>Pipelines</strong></em> üëâ <em><strong>Releases</strong></em> and click on <em><strong>New pipeline</strong></em>..</p><p>In the wizard, we will choose the <em><strong>Deploy a function app to Azure Functions..</strong></em></p><div align=center><p><img loading=lazy src=../images/devops-release-step1.webp alt></p></div><p>Next.. in the <em><strong>Artifacts</strong></em> source, we will define the <em>Source</em> (which is the Build pipeline) to the one that we created in the previous step:</p><div align=center><p><img loading=lazy src=../images/devops-release-source.webp alt></p></div><p>Next.. we need to enable the <em><strong>Continuous deployment trigger</strong></em> to create a release every time a new build is available:</p><div align=center><p><img loading=lazy src=../images/devops-release-cd-trigger.webp alt></p></div><p>Now, we will go to configure the <em><strong>Stage 1</strong></em> of the <em><strong>Release Pipeline</strong></em>:</p><p>In this step, we need to give the access of the <em><strong>Azure DevOps Pipeline</strong></em> to the <em><strong>Azure Subscription</strong></em>:</p><div align=center><p><img loading=lazy src=../images/devops-release-cd-auth.webp alt></p></div><p>Choose your <em><strong>Azure Subscription</strong></em>, and next click on <strong><em>Authorize</em></strong>¬†to configure an <strong><em>Azure service connection</em></strong>. A new <em><strong>Azure service principal</strong></em> will be created and added to the Contributor role, having access to all resources in the selected subscription.</p><p>In the :</p><ul><li>App type, choose the <strong>Function App on Windows</strong></li><li>App Service name, enter the application name that we created in the beginning: <strong>hello-world-example</strong></li></ul><div align=center><p><img loading=lazy src=../images/devops-release-cd-stage1-configuration.webp alt></p></div><p>Next.. click on the <em><strong>Deploy Azure Function App</strong></em> step to configure it:</p><p>In the <strong><em>Package or Folder</em></strong> choose: <code>$(System.DefaultWorkingDirectory)/_hello-azure-functions-Maven-CI/drop/target/azure-functions/hello-world-example</code></p><div align=center><p><img loading=lazy src=../images/devops-release-step-folder-package.webp alt></p></div><p>Next.. click on <em><strong>Create Release</strong></em> to create a new <em><strong>Release</strong></em>:</p><div align=center><p><img loading=lazy src=../images/devops-release-cd-stage1-create-release.webp alt></p></div><p>Click <em><strong>Create</strong></em> and click next on the Release name that is shown, to follow the build process:</p><div align=center><p><img loading=lazy src=../images/devops-release-cd-stage1-release-name.webp alt>
¬†</p></div><p>The Release build process will look like:</p><div align=center><p><img loading=lazy src=../images/devops-release-cd-building-release.webp alt></p></div><p>We need to wait until the <em><strong>Build</strong></em> succeeds:</p><div align=center><p><img loading=lazy src=../images/devops-release-cd-release-build-finish.webp alt></p></div><p>Now.. go back to the <a href=https://portal.azure.com>Azure Portal</a> üëâ <em>Resource Groups</em> called <em><strong>hello-world-example-rg</strong>üëâ Function App</em> called <em><strong>hello-world-example</strong></em>:</p><div align=center><p><img loading=lazy src=../images/function-app-content.webp alt></p></div><p>Under the <em><strong>Function Apps</strong></em> there are our <strong><em>hello-world-example</em></strong> application. In this tree there is a <em><strong>Functions (Read Only)</strong></em> section, which lists all the Functions that are included in our application.</p><p>If you click on the HttpTrigger-Java you will get something that looks like this:</p><div align=center><p><img loading=lazy src=../images/faas-http-trigger-java-content.webp alt></p></div><p>Click on <strong>&lt;/> Get function URL</strong> to get and test the function URL:</p><div align=center><p><img loading=lazy src=../images/faas-http-trigger-java-url.webp alt></p></div><p>When you click Copy and you past it to a browser you can see the function response which looks like</p><p>Please pass a name on the query string or in the request body</p><p>WTF!! üò±üò±üò±üò±</p><p>This is normal, the sample function needs some specific input to provide some response. So, now we will dive into the <em><strong>Java</strong></em> ecosystem ü•∞</p><p>Let&rsquo;s look to the sample project:</p><div align=center><p><img loading=lazy src=../images/faas-sample-project-structure.webp alt></p></div><p>In the sample project, we have only one <em><strong>Java</strong></em> class called <strong>Function</strong>. It&rsquo;s content looks like:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Function</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@FunctionName</span><span class=o>(</span><span class=s>&#34;HttpTrigger-Java&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>HttpResponseMessage</span> <span class=nf>run</span><span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=nd>@HttpTrigger</span><span class=o>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&#34;req&#34;</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>                        <span class=n>methods</span> <span class=o>=</span> <span class=o>{</span><span class=n>HttpMethod</span><span class=o>.</span><span class=na>GET</span><span class=o>,</span> <span class=n>HttpMethod</span><span class=o>.</span><span class=na>POST</span><span class=o>},</span> 
</span></span><span class=line><span class=cl>                        <span class=n>authLevel</span> <span class=o>=</span> <span class=n>AuthorizationLevel</span><span class=o>.</span><span class=na>FUNCTION</span><span class=o>)</span> 
</span></span><span class=line><span class=cl>                    <span class=n>HttpRequestMessage</span><span class=o>&lt;</span><span class=n>Optional</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;&gt;</span> <span class=n>request</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                    <span class=kd>final</span> <span class=n>ExecutionContext</span> <span class=n>context</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>context</span><span class=o>.</span><span class=na>getLogger</span><span class=o>().</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;Java HTTP trigger processed a request.&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Parse query parameter
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>query</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=na>getQueryParameters</span><span class=o>().</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>name</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=na>getBody</span><span class=o>().</span><span class=na>orElse</span><span class=o>(</span><span class=n>query</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>name</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>createResponseBuilder</span><span class=o>(</span><span class=n>HttpStatus</span><span class=o>.</span><span class=na>BAD_REQUEST</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>body</span><span class=o>(</span><span class=s>&#34;Please pass a name on the query string or in the request body&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>build</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>createResponseBuilder</span><span class=o>(</span><span class=n>HttpStatus</span><span class=o>.</span><span class=na>OK</span><span class=o>).</span><span class=na>body</span><span class=o>(</span><span class=s>&#34;Hello, &#34;</span> <span class=o>+</span> <span class=n>name</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=na>build</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>In the line (5) we have the <code>@FunctionName</code>¬† annotation that contains the <strong>HttpTrigger-Java</strong> which is the <strong><em>Function</em></strong> name. This indicates that this function will be available at the endpoint <code>/api/HttpTrigger-Java</code>.</p><p>There is only one method called <code>run(...)</code>¬† which is the <em><strong>Function</strong></em> body; we pass to this method some arguments:</p><ul><li><code>HttpRequestMessage&lt;Optional&lt;String>> request</code> : This indicates that the body of the request will potentially contain a String value - this argument is annotated with the <code>@HttpTrigger</code> annotation. In this annotation you&rsquo;ll note that it has been given a name <em><strong>req</strong></em>, as well as told what type of requests it supports (in this case, only <em>HTTP GET</em> and <em>POST</em> requests), and that the <a href=http://localhost:63342/helloworld-functions/azure-functions-java-library-1.3.0-javadoc.jar/com/microsoft/azure/functions/annotation/AuthorizationLevel.html title="enum in com.microsoft.azure.functions.annotation"><code>AuthorizationLevel</code></a>¬†is anonymous, allowing access to anyone who can call the endpoint.</li><li><code>final ExecutionContext context</code>¬† : The execution context enables interaction with the Azure Functions execution environment. Used for accessing the Java Logger that will see output directed to Azure Portal, as well as any other configured output¬†locations.</li></ul><p>So based on this code, if I add a name parameter to the Function URL, I will get a response üòÅ</p><p>The <strong>old URL</strong> is :</p><p><a href="https://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==">https://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==</a></p><p>The <strong>new URL with the name parameter</strong> will look like:</p><p><a href="https://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?name=nebrass&code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==">https://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?name=nebrass&code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==</a></p><p>We will get a response like <code>Hello, nebrass</code>¬†ü•≥</p><p>Now, we can change a little bit the code of our HttpTrigger-Java function to be like:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Function</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@FunctionName</span><span class=o>(</span><span class=s>&#34;HttpTrigger-Java&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>HttpResponseMessage</span> <span class=nf>run</span><span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=nd>@HttpTrigger</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>name</span> <span class=o>=</span> <span class=s>&#34;req&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>methods</span> <span class=o>=</span> <span class=o>{</span><span class=n>HttpMethod</span><span class=o>.</span><span class=na>GET</span><span class=o>,</span> <span class=n>HttpMethod</span><span class=o>.</span><span class=na>POST</span><span class=o>},</span>
</span></span><span class=line><span class=cl>                    <span class=n>authLevel</span> <span class=o>=</span> <span class=n>AuthorizationLevel</span><span class=o>.</span><span class=na>FUNCTION</span>
</span></span><span class=line><span class=cl>            <span class=o>)</span> <span class=n>HttpRequestMessage</span><span class=o>&lt;</span><span class=n>Optional</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;&gt;</span> <span class=n>request</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=kd>final</span> <span class=n>ExecutionContext</span> <span class=n>context</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>context</span><span class=o>.</span><span class=na>getLogger</span><span class=o>().</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;Java HTTP trigger processed a request.&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>request</span><span class=o>.</span><span class=na>createResponseBuilder</span><span class=o>(</span><span class=n>HttpStatus</span><span class=o>.</span><span class=na>OK</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>body</span><span class=o>(</span><span class=s>&#34;Hello World at &#34;</span> <span class=o>+</span> <span class=n>LocalDateTime</span><span class=o>.</span><span class=na>now</span><span class=o>().</span><span class=na>toString</span><span class=o>())</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=na>build</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>After you commit, the <strong>Build pipeline</strong> will be executed and when it succeeds, the <strong>Release pipeline</strong> will be started to deploy the new code.</p><p>If you go now to the function URL:</p><p><a href="https://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==">https://hello-world-example.azurewebsites.net/api/HttpTrigger-Java?code=phKRPlOlAsjlZqiYbOnMaZtu/z66RAY91MqKQ1lwbofXGvlZcggArg==</a></p><p>You will get the new output message: <code>Hello World at 2019-08-09T12:25:24.035</code></p><h2 id=triggers-and-bindings>Triggers and bindings<a hidden class=anchor aria-hidden=true href=#triggers-and-bindings>#</a></h2><p>I will be covering more the <strong>Triggers and Bindings</strong> in my next post about the fabulous <strong>Azure Java Functions</strong>:</p><p><a href=https://blog.nebrass.fr/playing-with-java-in-azure-functions-new-release/>https://blog.nebrass.fr/playing-with-java-in-azure-functions-new-release/</a></p><h2 id=do-more->Do more üòé<a hidden class=anchor aria-hidden=true href=#do-more->#</a></h2><p>You can do more with <em><strong>Azure Functions</strong></em>:</p><ul><li><a href=https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference-java>Azure Functions Java developer guide</a></li><li><a href=https://spring.io/blog/2018/09/25/spring-cloud-function-2-0-and-azure-functions>Spring Cloud Function 2.0 and Azure Functions</a></li></ul><h2 id=not-final-words>Not final words<a hidden class=anchor aria-hidden=true href=#not-final-words>#</a></h2><p>The <em><strong>Azure Functions</strong></em> is a very powerful product and it can be very useful in many use-cases when we are working with <em>events-driven logic</em> such as doing some business tasks when new file is uploaded in <em><strong>Azure Storage</strong></em> or when a new message is dispatched to <em><strong>Azure Event Hub</strong></em>.</p><p>Actually, <em><strong>Azure Functions</strong></em> support <strong>Java 8</strong>. To follow updates about the Java 11 and 12 support check <a href=https://github.com/Azure/azure-functions-java-worker/issues/120>this ticket</a> and <a href=https://github.com/Azure/azure-functions-java-worker/issues/194>this one</a> also.</p></div><footer class=post-footer><ul class=post-tags></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Playing with Java in Azure Functions and Azure DevOps on twitter" href="https://twitter.com/intent/tweet/?text=Playing%20with%20Java%20in%20Azure%20Functions%20and%20Azure%20DevOps&url=https%3a%2f%2fblog.nebrass.fr%2fplaying-with-java-in-azure-functions-and-azure-devops%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Playing with Java in Azure Functions and Azure DevOps on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.nebrass.fr%2fplaying-with-java-in-azure-functions-and-azure-devops%2f&title=Playing%20with%20Java%20in%20Azure%20Functions%20and%20Azure%20DevOps&summary=Playing%20with%20Java%20in%20Azure%20Functions%20and%20Azure%20DevOps&source=https%3a%2f%2fblog.nebrass.fr%2fplaying-with-java-in-azure-functions-and-azure-devops%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Playing with Java in Azure Functions and Azure DevOps on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.nebrass.fr%2fplaying-with-java-in-azure-functions-and-azure-devops%2f&title=Playing%20with%20Java%20in%20Azure%20Functions%20and%20Azure%20DevOps"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Playing with Java in Azure Functions and Azure DevOps on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.nebrass.fr%2fplaying-with-java-in-azure-functions-and-azure-devops%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Playing with Java in Azure Functions and Azure DevOps on whatsapp" href="https://api.whatsapp.com/send?text=Playing%20with%20Java%20in%20Azure%20Functions%20and%20Azure%20DevOps%20-%20https%3a%2f%2fblog.nebrass.fr%2fplaying-with-java-in-azure-functions-and-azure-devops%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Playing with Java in Azure Functions and Azure DevOps on telegram" href="https://telegram.me/share/url?text=Playing%20with%20Java%20in%20Azure%20Functions%20and%20Azure%20DevOps&url=https%3a%2f%2fblog.nebrass.fr%2fplaying-with-java-in-azure-functions-and-azure-devops%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.nebrass.fr>Nebrass Homepage</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>